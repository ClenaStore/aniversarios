<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Loja • Estilo Instagram</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{font-family:Arial, sans-serif;background:#fafafa;margin:0;color:#111}
    header{padding:14px;background:#fff;border-bottom:1px solid #ddd;display:flex;align-items:center;gap:12px}
    .perfil-foto{width:60px;height:60px;border-radius:50%;object-fit:cover}
    .perfil-info h1{margin:0;font-size:18px}
    .perfil-info p{margin:2px 0;color:#555;font-size:13px}

    .stories{display:flex;gap:12px;padding:12px;overflow-x:auto;background:#fff;border-bottom:1px solid #ddd}
    .story{width:60px;height:60px;border-radius:50%;overflow:hidden;border:2px solid #ff0066;flex:0 0 auto}
    .story img{width:100%;height:100%;object-fit:cover}

    /* Post estilo feed */
    .post{background:#fff;margin-bottom:20px;border:1px solid #ddd}
    .post-header{display:flex;align-items:center;gap:8px;padding:10px}
    .post-header img{width:32px;height:32px;border-radius:50%}
    .post-header span{font-weight:600;font-size:14px}
    .post img{width:100%;max-height:400px;object-fit:cover}
    .post-body{padding:10px}
    .price{color:#16a34a;font-weight:bold;margin:4px 0}
    .pubdate{font-size:12px;color:#777;margin-top:4px}
    .btn{background:#16a34a;color:#fff;padding:6px 10px;border-radius:6px;text-decoration:none;display:inline-block;margin-top:8px;font-size:13px}
  </style>
</head>
<body>
  <header>
    <img id="perfilFoto" class="perfil-foto" src="">
    <div class="perfil-info">
      <h1 id="perfilNome"></h1>
      <p id="perfilBio"></p>
    </div>
  </header>

  <section class="stories" id="stories"></section>

  <main id="feed" style="padding:10px;"></main>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbyVUcV4Z9x3tQZy4z0SDg37lTCy0aHcjoyOeVQsQU4ClJxrMQhxYEwwLqATWGK27Wv4aQ/exec";
    let lojaAtual = "loja1"; // muda para a loja certa

    fetch(API_URL)
      .then(r=>r.json())
      .then(data=>{
        const loja = data.lojas.find(l=>l.id_loja===lojaAtual);
        document.getElementById("perfilFoto").src = loja.perfil_foto;
        document.getElementById("perfilNome").textContent = loja.nome;
        document.getElementById("perfilBio").textContent = loja.bio;

        // Stories
        const stories = (loja.stories||"").split(",");
        const storiesDiv = document.getElementById("stories");
        stories.forEach(url=>{
          if(url.trim()){
            const div=document.createElement("div");
            div.className="story";
            div.innerHTML=`<img src="${url.trim()}">`;
            storiesDiv.appendChild(div);
          }
        });

        // Feed de produtos
        const feed = document.getElementById("feed");
        const produtos = data.produtos.filter(p=>p.loja===lojaAtual);
        produtos.forEach(p=>{
          const div=document.createElement("div");
          div.className="post";
          div.innerHTML=`
            <div class="post-header">
              <img src="${loja.perfil_foto}">
              <span>${loja.nome}</span>
            </div>
            <img src="${p.foto}" alt="${p.nome}">
            <div class="post-body">
              <strong>${p.nome}</strong><br>
              <span class="price">R$ ${Number(p.preco).toFixed(2)}</span>
              <p>${p.descricao}</p>
              <div class="pubdate">${p.datahora}</div>
              <a href="https://wa.me/${p.whatsapp}?text=${encodeURIComponent("Olá! Tenho interesse neste produto: "+p.nome+" - R$ "+p.preco)}" class="btn" target="_blank">WhatsApp</a>
            </div>
          `;
          feed.appendChild(div);
        });
      });
  </script>
</body>
</html>
