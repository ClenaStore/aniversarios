<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Bazar Online</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{font-family:Arial, sans-serif;background:#f9fafb;margin:0;color:#111}
    header{position:absolute;top:10px;left:20px;z-index:20}
    header img{height:50px}

    .banner{position:relative;height:280px;overflow:hidden}
    .slide{position:absolute;inset:0;opacity:0;transition:opacity 1s ease;background-position:center;background-size:cover}
    .slide.active{opacity:1}
    .banner-dots{position:absolute;bottom:12px;left:0;right:0;display:flex;gap:6px;justify-content:center}
    .dot{width:10px;height:10px;border-radius:50%;background:rgba(255,255,255,.5);cursor:pointer}
    .dot.active{background:#fff}

    .toolbar{display:flex;gap:10px;align-items:center;padding:14px 16px;background:#fff;box-shadow:0 2px 4px rgba(0,0,0,.08)}
    .search{flex:1;padding:10px;border:1px solid #ccc;border-radius:6px}
    .filter{padding:10px;border:1px solid #ccc;border-radius:6px}

    .grid{display:grid;gap:16px;padding:20px;
          grid-template-columns:repeat(2,1fr);}
    @media(min-width:900px){.grid{grid-template-columns:repeat(6,1fr);}}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;overflow:hidden;cursor:pointer;transition:.2s;display:flex;flex-direction:column;box-shadow:0 4px 8px rgba(0,0,0,.05)}
    .card:hover{transform:translateY(-2px);box-shadow:0 6px 14px rgba(0,0,0,.1)}
    .card img{width:100%;height:130px;object-fit:cover}
    .card .info{padding:10px;flex:1}
    .card h3{margin:0;font-size:14px;font-weight:600}
    .card .price{color:#16a34a;font-weight:bold;margin:6px 0}
    .flag{font-size:11px;color:#555;border:1px dashed #ccc;border-radius:999px;padding:2px 6px;display:inline-block;margin-top:4px}
    .pubdate{font-size:11px;color:#777;margin-top:6px;display:block}

    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);align-items:center;justify-content:center;z-index:100}
    .modal.active{display:flex}
    .modal-content{background:#fff;padding:20px;border-radius:12px;max-width:420px;width:90%;text-align:center;position:relative;box-shadow:0 6px 20px rgba(0,0,0,.2)}
    .modal-content img{width:100%;border-radius:8px;margin-bottom:12px}
    .close{position:absolute;top:10px;right:12px;font-size:20px;cursor:pointer}
    .btn{background:#16a34a;color:#fff;padding:10px 14px;border:none;border-radius:8px;cursor:pointer;text-decoration:none;display:inline-block;margin-top:10px}

    .pagination{display:flex;justify-content:center;gap:8px;margin:20px}
    .pagination button{padding:8px 12px;border:1px solid #ccc;background:#fff;border-radius:6px;cursor:pointer}
    .pagination button.active{background:#16a34a;color:#fff;border-color:#16a34a}

    footer{background:#fff;border-top:1px solid #e5e7eb;padding:20px;text-align:center;font-size:13px;color:#555;margin-top:30px}
  </style>
</head>
<body>
  <header>
    <img src="SUA_LOGO_AQUI.png" alt="Logo">
  </header>

  <section class="banner" id="banner">
    <div class="slide active" style="background-image:url('https://images.unsplash.com/photo-1483985988355-763728e1935b?q=80&w=1600&auto=format&fit=crop');"></div>
    <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1520975622034-763f2f2997c7?q=80&w=1600&auto=format&fit=crop');"></div>
    <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1517630800677-932d836ab680?q=80&w=1600&auto=format&fit=crop');"></div>
    <div class="banner-dots">
      <div class="dot active"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
  </section>

  <div class="toolbar">
    <input id="search" class="search" type="search" placeholder="Buscar produto...">
    <select id="filter" class="filter">
      <option value="Todos">Todos</option>
      <option value="Novo">Novo</option>
      <option value="Usado">Usado</option>
    </select>
  </div>

  <main>
    <div id="grid" class="grid"></div>
    <div id="pagination" class="pagination"></div>
  </main>

  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <img id="mFoto" src="">
      <h2 id="mNome"></h2>
      <div id="mPreco"></div>
      <p id="mDesc"></p>
      <span id="mFlag" class="flag"></span>
      <div id="mData" class="pubdate"></div>
      <br>
      <a id="mWhats" class="btn" target="_blank">Falar no WhatsApp</a>
    </div>
  </div>

  <footer>
    <p><strong>Termos de Compras:</strong> Aqui você pode colocar suas políticas de compra, devolução e contato.</p>
  </footer>

  <script>
    const GRID = document.getElementById("grid");
    const MODAL = document.getElementById("modal");
    const PAGINATION = document.getElementById("pagination");
    const API_URL = "https://script.google.com/macros/s/AKfycbwnqfnI5g1c-u-YJDc1QQ8wqXKx7CUOH0iR6YgbyEOmNp9ZnszKkKrPQFV6fpOM2dnKQQ/exec"; 
    let produtos = [];
    let currentPage = 1;
    const perPage = 20;

    // Formatador de data/hora
    function formatDate(str){
      try {
        const d = new Date(str);
        return d.toLocaleDateString("pt-BR")+" - "+d.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});
      } catch {
        return str; // caso já venha formatado da planilha
      }
    }

    (function(){
      const slides = [...document.querySelectorAll(".slide")];
      const dots = [...document.querySelectorAll(".dot")];
      let i=0;
      setInterval(()=>{
        slides[i].classList.remove("active");
        dots[i].classList.remove("active");
        i = (i+1)%slides.length;
        slides[i].classList.add("active");
        dots[i].classList.add("active");
      },4000);
    })();

    fetch(API_URL)
      .then(r=>r.json())
      .then(data=>{
        produtos = data;
        applyFilters();
      });

    function render(list){
      GRID.innerHTML = "";
      list.forEach((p)=>{
        const card = document.createElement("div");
        card.className="card";
        card.innerHTML=`
          <img src="${p.foto}" alt="${p.nome}">
          <div class="info">
            <h3>${p.nome}</h3>
            <div class="price">R$ ${Number(p.preco).toFixed(2)}</div>
            <span class="flag">${p.flag}</span>
            <span class="pubdate">${formatDate(p.datahora)}</span>
          </div>`;
        card.onclick = ()=> openModal(p);
        GRID.appendChild(card);
      });
    }

    function openModal(p){
      document.getElementById("mFoto").src=p.foto;
      document.getElementById("mNome").textContent=p.nome;
      document.getElementById("mPreco").textContent="R$ "+Number(p.preco).toFixed(2);
      document.getElementById("mDesc").textContent=p.descricao;
      document.getElementById("mFlag").textContent=p.flag;
      document.getElementById("mData").textContent = formatDate(p.datahora);
      const msg=`Olá! Tenho interesse neste produto:\n\n${p.nome}\nValor: R$ ${Number(p.preco).toFixed(2)}\n${p.descricao}`;
      document.getElementById("mWhats").href=`https://wa.me/${p.whatsapp}?text=${encodeURIComponent(msg)}`;
      MODAL.classList.add("active");
    }
    function closeModal(){ MODAL.classList.remove("active"); }

    function paginate(list,page=1){
      const start = (page-1)*perPage;
      const end = start+perPage;
      return list.slice(start,end);
    }
    function renderPagination(total){
      PAGINATION.innerHTML="";
      const pages = Math.ceil(total/perPage);
      for(let i=1;i<=pages;i++){
        const btn = document.createElement("button");
        btn.textContent=i;
        if(i===currentPage) btn.classList.add("active");
        btn.onclick=()=>{currentPage=i;applyFilters();}
        PAGINATION.appendChild(btn);
      }
    }

    document.getElementById("search").addEventListener("input", applyFilters);
    document.getElementById("filter").addEventListener("change", applyFilters);

    function applyFilters(){
      const q = document.getElementById("search").value.toLowerCase();
      const f = document.getElementById("filter").value;
      const filtered = produtos.filter(p=>{
        const matchesSearch = p.nome.toLowerCase().includes(q) || p.descricao.toLowerCase().includes(q);
        const matchesFlag = (f==="Todos") || (p.flag===f);
        return matchesSearch && matchesFlag;
      });
      render(paginate(filtered,currentPage));
      renderPagination(filtered.length);
    }
  </script>
</body>
</html>
